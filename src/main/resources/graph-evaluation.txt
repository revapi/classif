+-----+                        1 uses 2
|  1  |<------------\          2 uses 3
+-----+             |          3 uses 1,2
   |                |
   |             +-----+
   | /-----------|  3  |
   v v           +-----+
+-----+            ^
|  2  |------------/
+-----+

1) Unwind cycles

+-----+
|  1  |<---------------------------\
+-----+                            |
  ||                               |
  ||                            +-----+
  ||           /----------------|  3  |
  ||           |                +-----+
  ||           |                   ^
  ||           v                   |
  ||        +-----+           +-----+
  |\------->|  2' |           | 2'' |
  |         +-----+           +-----+
  |                             ^
  \-----------------------------/



+-----+
|  1  |<-------------\
+-----+              |
 ||                  |
 ||               +-----+       +-----+
 ||     /---------|  3' |       | 3'' |
 ||     |         +-----+       +-----+
 ||     |                          |^
 ||     |/-------------------------/|
 ||     vv                          |
 ||  +------+     +------+          |
 |\->|  2'  |     |  2'' |----------/
 |   +------+     +------+
 |                  ^
 \------------------/

 2) Reduce out-cardinality of all nodes


                                                                          1'    uses 2''
    /---------------------------------------\                             1''   uses 2'
    |             /-------------\           |                             2'
    v             v             |           |                             2''   uses 3'''
 +-----+       +-----+          |           |                             3'    uses 1'', 2'
 |  1' |       | 1'' |          |           |                             3''   uses 1', 2'
 +-----+       +-----+          |           |                             3'''  uses 2', *
   |            |               |           |
   |            |               |           |
   |            |               |           |
   |            |               |           |
   |            |               |           |
   |            |               |           |
   |            |               |           |
   |            |            +-----+     +-----+    +------+
   |   /--------/ /----------|  3' |  /--| 3'' |    | 3''' |
   |   |/---------/          +-----+  |  +-----+    +------+
   |   ||/----------------------------/               | ^
   |   |||/-------------------------------------------/ |
   |   ||||                                             |
   |   ||||                                             |
   |   ||||                                             |
   |   vvvv                                             |
   |  +------+    +------+                              |
   |  |  2'  |    |  2'' |------------------------------/
   |  +------+    +------+
   |                 ^
   \----------------/


3) Evaluation

1 ~ A, AA
2 ~ B, BB
3 ~ C, CC

A uses B
B uses C
C uses A, B

ret B

1)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v						? A

2)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v						? A
AA	v	v						? AA

3)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v	v	v				? A,B
AA	v	v						? AA
B			v	v				? B

4)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v	v	v				? A,B
AA	v	v						? AA
B			v	v				? B
BB			v	v				? BB

5)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v	v	v			v	v A,B,C
AA	v	v						? AA
B			v	v			v	? B,C
BB			v	v				? BB
C					v	v	v	? C

6)
	1’	1’’	2’	2’’	3’	3’’	3’’’	Result
A	v	v	v	v			v	v A,B,C      Matches B (ret B) because there is a match in each splitgroup for some element
AA	v	v						x AA
B			v	v			v	x B,C
BB			v	v				x BB
C					v	v	v	x C
EOF
